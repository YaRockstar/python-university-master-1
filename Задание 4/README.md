# Transport Company Management System

**Версия:** 1.2  
**Язык:** Python 3.13 (рекомендуемая версия)  
**Автор:** Калашников Ярослав

Система учёта и управления транспортной компанией, демонстрируя принципы объектно-ориентированного
программирования,  
паттерны проектирования и работу с данными транспортных средств и водителей.

---

## Описание проекта

Программа позволяет:

- Создавать и управлять транспортными средствами различных типов:
    - `Bus` — автобус с указанием номера маршрута
    - `Truck` — грузовик с указанием грузоподъёмности
    - `Taxi` — такси с указанием номерного знака
- Маршруты как отдельные сущности не реализованы, но автобус содержит номер маршрута (`route_number`)
- Создавать водителей и закреплять за ними транспортные средства
- Вести учёт адресов водителей через композицию (`Address`)
- Отслеживать местоположение и формировать отчёты по рейсам через интерфейсы `Trackable` и `Reportable`
- Добавлять, редактировать, удалять и искать транспортные средства в парке
- Выполнять анализ парка (вместимость по типам и моделям)
- Проверять права пользователей с помощью **декоратора** `check_permissions`
- Логировать все действия и отправлять уведомления (через миксины `LoggingMixin` и `NotificationMixin`)
- Обрабатывать заявки на техобслуживание через **цепочку обязанностей** (`Mechanic → DepartmentHead → Director`)
- Стандартизировать расчёт стоимости эксплуатации через **шаблонный метод** (`CostCalculator`)
- Создавать транспортные средства через **фабричный метод** (`VehicleFactory`)
- Использовать **метакласс** (`VehicleMeta`) для автоматической регистрации подклассов `Vehicle`
- Сохранять и загружать данные о транспорте и водителях в единый JSON-файл (`transport_company.json`)
- Обрабатывать пользовательские исключения при ошибках данных и доступе

Проект демонстрирует:

- Наследование, композицию и агрегацию
- Абстрактные классы и интерфейсы
- Миксины (`LoggingMixin`, `NotificationMixin`)
- Метаклассы (`VehicleMeta`) и фабричный метод (`VehicleFactory`)
- Паттерны проектирования: **Цепочка обязанностей**, **Шаблонный метод**
- Исключения и обработку ошибок
- Сериализацию, логирование и документацию
- Гибкую архитектуру для масштабирования (например, лёгкое добавление новых типов ТС, логики обслуживания или сущностей
  вроде маршрутов/рейсов при необходимости)
- **Чистую архитектуру** с разделением на слои (core, domain, infrastructure, application)

---

## Структура проекта

```
Задание 4/
├── main.py                    # Точка входа
│
├── core/                      # Базовые классы и интерфейсы
│   ├── interfaces.py          # Trackable, Reportable
│   ├── exceptions.py          # Исключения
│   ├── mixins.py              # LoggingMixin, NotificationMixin
│   └── meta.py                # VehicleMeta (метакласс)
│
├── domain/                    # Доменные модели (бизнес-сущности)
│   ├── user.py                # Модель пользователя
│   ├── address.py             # Модель адреса
│   ├── vehicle.py             # Модели ТС (Vehicle, Bus, Truck, Taxi, TrackableBus, ReportableTaxi)
│   └── driver.py              # Модель водителя
│
├── infrastructure/            # Инфраструктурный слой
│   ├── config.py              # Конфигурация логирования
│   └── factories.py           # Фабрики (VehicleFactory)
│
├── application/               # Прикладной слой (бизнес-логика)
│   ├── services/              # Сервисы
│   │   └── transport_company.py
│   └── patterns/              # Паттерны проектирования
│       ├── chain_of_responsibility.py
│       └── template_method.py
│
├── utils/                      # Утилиты
│   └── decorators.py          # Декораторы (check_permissions)
│
├── data/                      # Директория для данных
│   └── transport_company.json # Файл с данными компании
│
└── logs/                      # Директория для логов
    └── transport_company.log  # Файл логов
```

---

## Установка и запуск

### Способ 1: Запуск из директории проекта (рекомендуется)

1. Перейдите в директорию проекта:

```bash
cd "Задание 4"
```

2. Запустите программу:

```bash
python3 main.py
```

### Способ 2: Запуск из родительской директории

Если вы находитесь в родительской директории, используйте:

```bash
python3 "Задание 4/main.py"
```

Или установите PYTHONPATH:

```bash
export PYTHONPATH="${PYTHONPATH}:$(pwd)/Задание 4"
python3 "Задание 4/main.py"
```

### Способ 3: Использование модуля Python

```bash
cd "Задание 4"
python3 -m main
```

---

## Результаты работы

После запуска программа:

1. Создаёт транспортные средства разных типов
2. Добавляет водителей и назначает их на ТС
3. Выполняет поиск и анализ данных
4. Демонстрирует работу паттернов проектирования
5. Показывает обработку пользовательских исключений (`PermissionDeniedError`, `DriverNotFoundError`,
   `InvalidVehicleError`)
6. Сохраняет данные в `transport_company.json`
7. Записывает логи в `logs/transport_company.log`

---

## Пример использования

Ниже приведён базовый пример. Полная демонстрация функций (цепочка обязанностей, шаблонный метод, сериализация,
исключения) находится в `main.py`.

```python
from infrastructure.config import logger
from domain import User, Address, Driver, ReportableTaxi
from infrastructure.factories import VehicleFactory
from application.services import TransportCompany

# Создание пользователей
admin = User("alice", ["admin"])

# Создание компании
company = TransportCompany("TransCo")

# Создание транспортного средства через фабрику
bus = VehicleFactory.create_vehicle(
    "bus",
    vehicle_id="B-1",
    model="LiAZ-5292",
    year=2020,
    capacity=110,
    route_number="42"
)

# Добавление ТС в компанию
company.add_vehicle(user=admin, vehicle=bus)
```

---

## Требования

- Python 3.10+ (минимум 3.7+)
- Стандартная библиотека Python (без дополнительных зависимостей)

---

## Примечания

- **Логи** сохраняются в директории `logs/transport_company.log`
- **Данные** сохраняются в директории `data/transport_company.json`
- Директории `logs/` и `data/` создаются автоматически при первом запуске
- Все модули используют абсолютные импорты, поэтому запуск должен происходить из директории проекта или с установленным
  PYTHONPATH
- Методы `save()` и `load()` класса `TransportCompany` по умолчанию используют `data/transport_company.json`
